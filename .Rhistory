View(NSD3201)
# Lager færre nivåer på utdanning for enklere tolkning
NSD3201 <- NSD3201 %>%
filter(Utdanning != 9) %>%  # dropp uoppgitt helt
mutate(
Utdanning_grupper = case_when(
Utdanning %in% 2                     ~ "Grunnskole eller mindre",
Utdanning %in% c(3, 4, 5)            ~ "Videregående",
Utdanning %in% c(6, 7)               ~ "Universitet/Høgskole",
Utdanning == 8                       ~ "Forskernivå"
),
Utdanning_grupper = factor(
Utdanning_grupper,
levels = c(
"Grunnskole eller mindre",
"Videregående",
"Universitet/Høgskole",
"Forskernivå"
)
)
)
ggplot(NSD3201, aes(Alder)) + geom_histogram(bins = 30, fill = "blue", color = "black") +
labs(title = "", x = "", y = "Antall observasjoner") +
theme_minimal()
NSD3201 %>%
select(Sykefravær_2022, Alder, Utdanning, Kjønn, Tilfredshet, Motivasjon, Barn,
Støtte_sjef, Støtte_kollega, Tilbakemelding_sjef, Arbeidsresultater,
Grad_selvbestemming_oppgaver, Grad_selvbestemming_arbeid_som_skal_gjøres,
Grad_arbeidstempo, Grad_påvirke_beslutning_arbeid,
For_mye_arbeid, Høyt_arbeidstempo, Ekstra_arbeid) %>%
summary()
library(kableExtra)
# 1) Først sørg for at du har formue_gruppe som faktor med labels c("Lav","Middels","Høy")
#    (antatt allerede laget tidligere)
# 2) Velg hvilke variabler du vil beskrive
vars <- c("Sykefravær_2022", "Alder", "Tilfredshet", "Motivasjon")
# 3) Lag deskriptiv per formuegruppe
df_formue_deskr <- NSD3201 %>%
group_by(formue_gruppe) %>%
summarise(across(all_of(vars),
list(N    = ~n(),
Mean = ~round(mean(.x, na.rm = TRUE), 2),
SD   = ~round(sd(.x,   na.rm = TRUE), 2)),
.names = "{.col}_{.fn}")) %>%
ungroup()
# 3) Lag deskriptiv per formuegruppe
df_formue_deskr <- NSD3201 %>%
group_by(Formue_grupper) %>%
summarise(across(all_of(vars),
list(N    = ~n(),
Mean = ~round(mean(.x, na.rm = TRUE), 2),
SD   = ~round(sd(.x,   na.rm = TRUE), 2)),
.names = "{.col}_{.fn}")) %>%
ungroup()
# 4) Snu data slik at grupper blir kolonner
df_formue_wide <- df_formue_deskr %>%
pivot_longer(-formue_gruppe,
names_to = c("Variable", "Stat"),
names_sep = "_") %>%
pivot_wider(names_from = formue_gruppe, values_from = value)
# 4) Snu data slik at grupper blir kolonner
df_formue_wide <- df_formue_deskr %>%
pivot_longer(-Formue_grupper,
names_to = c("Variable", "Stat"),
names_sep = "_") %>%
pivot_wider(names_from = formue_gruppe, values_from = value)
# 4) Snu data slik at grupper blir kolonner
df_formue_wide <- df_formue_deskr %>%
pivot_longer(-Formue_grupper,
names_to = c("Variable", "Stat"),
names_sep = "_") %>%
pivot_wider(names_from = Formue_grupper, values_from = value)
# 5) Skriv ut som LaTeX-tabell
df_formue_wide %>%
arrange(Variable, Stat) %>%
kable("latex", booktabs = TRUE,
caption = "Deskriptiv statistikk etter formuegruppe",
label   = "tab:deskr_formue") %>%
kable_styling(latex_options = c("hold_position","repeat_header"))
rm(list = ls())
library(tidyverse)
library(zoo)
library(scales)
library(ggrepel)
library(readxl)
library(httr)
library(jsonlite)
library(rjstat)
library(readr)
NSD3201 <- read_csv("Data/NSD3201.csv", show_col_types = FALSE)
# count(NSD3201, wkapinnt+aksje+rentinnt > lonn)
# NSD3201 %>%
#   mutate(lonn = as.numeric(lonn),
#          wkapinnt = as.numeric(wkapinnt),
#          aksje = as.numeric(aksje),
#          rentinnt = as.numeric(rentinnt)) %>%
#   mutate(total = wkapinnt+aksje+rentinnt) %>%
#   mutate(diff = lonn - total) %>%
#   ggplot(aes(x = sfpros_uten_feriekorr_2022, y = diff)) +
#   geom_point()
# NSD3201 %>%
#   mutate(sfpros_uten_feriekorr_2022 = as.numeric(sfpros_uten_feriekorr_2022),
#          sfpros_uten_feriekorr_2023 = as.numeric(sfpros_uten_feriekorr_2023),
#          kullaldr = as.numeric(kullaldr)) %>%
#   ggplot(aes(x = kullaldr)) +
#   geom_point(aes(y=sfpros_uten_feriekorr_2023), color="red", alpha=0.4) +
#   geom_point(aes(y=sfpros_uten_feriekorr_2022), color="blue", alpha=0.2)
rm(list = ls())
library(tidyverse)
library(zoo)
library(scales)
library(ggrepel)
library(readxl)
library(httr)
library(jsonlite)
library(rjstat)
library(readr)
NSD3201 <- read_csv("Data/NSD3201.csv", show_col_types = FALSE)
# count(NSD3201, wkapinnt+aksje+rentinnt > lonn)
# NSD3201 %>%
#   mutate(lonn = as.numeric(lonn),
#          wkapinnt = as.numeric(wkapinnt),
#          aksje = as.numeric(aksje),
#          rentinnt = as.numeric(rentinnt)) %>%
#   mutate(total = wkapinnt+aksje+rentinnt) %>%
#   mutate(diff = lonn - total) %>%
#   ggplot(aes(x = sfpros_uten_feriekorr_2022, y = diff)) +
#   geom_point()
# NSD3201 %>%
#   mutate(sfpros_uten_feriekorr_2022 = as.numeric(sfpros_uten_feriekorr_2022),
#          sfpros_uten_feriekorr_2023 = as.numeric(sfpros_uten_feriekorr_2023),
#          kullaldr = as.numeric(kullaldr)) %>%
#   ggplot(aes(x = kullaldr)) +
#   geom_point(aes(y=sfpros_uten_feriekorr_2023), color="red", alpha=0.4) +
#   geom_point(aes(y=sfpros_uten_feriekorr_2022), color="blue", alpha=0.2)
NSD3201 <- NSD3201 %>%
transmute(
# Avhengig, hoveduavhengig og kontrollvariabler
Sykefravær_2022 = sfpros_uten_feriekorr_2022,
Sykefravær_2023 = sfpros_uten_feriekorr_2023,
Formue = agg_f_08,
Alder = kullaldr,
Utdanning = utdnivaa,
Kjønn = Kjonn,
Tilfredshet = Sp59g,
Motivasjon = SpMotEng_ny,
Barn = barn05,
# Jobbressurser
Støtte_sjef = QPS72_ny,
Støtte_kollega = QPS73_ny,
Tilbakemelding_sjef = Raad3a_ny,
Arbeidsresultater = QPS78_ny,
Grad_selvbestemming_oppgaver = Sp56a2,
Grad_selvbestemming_arbeid_som_skal_gjøres = Sp56b2,
Grad_arbeidstempo = QPS47,
Grad_påvirke_beslutning_arbeid = QPS53,
# Jobbkrav
For_mye_arbeid = QPS15_ny,
Høyt_arbeidstempo = QPS14_ny,
Ekstra_arbeid = Sp47f) %>%
#fjerner NA verdier
drop_na()
NSD3201 <- NSD3201 %>%
mutate(
Formue_grupper = ntile(Formue, 3),
Formue_grupper = factor(Formue_grupper,
levels = 1:3,
labels = c("Lav Formue", "Middels formue", "Høy formue")),
)
NSD3201 <- NSD3201 %>%
mutate(Log_formue = log1p(Formue))
# Ser verdier for formuegruppene
grenseverdier <- quantile(
NSD3201$Formue,
probs = c(0, 1/3, 2/3, 1),
na.rm = TRUE
)
# Deler alder inn i likt breddeintervall
NSD3201 <- NSD3201 %>%
mutate(
Alder_grupper = cut(Alder,
breaks = c(18, 30, 40, 50, 60, 66),
right = FALSE,
labels = c("18–29", "30–39", "40–49", "50–59", "60–66")
)
)
# Fikser Kjønn variabelen fra 1 og 2 til dummy
NSD3201 <- NSD3201 %>%
mutate(Kvinne = if_else(Kjønn == 2, 1L, 0L))
# Lager færre nivåer på utdanning for enklere tolkning
NSD3201 <- NSD3201 %>%
filter(Utdanning != 9) %>%  # dropp uoppgitt helt
mutate(
Utdanning_grupper = case_when(
Utdanning %in% 2                     ~ "Grunnskole eller mindre",
Utdanning %in% c(3, 4, 5)            ~ "Videregående",
Utdanning %in% c(6, 7)               ~ "Universitet/Høgskole",
Utdanning == 8                       ~ "Forskernivå"
),
Utdanning_grupper = factor(
Utdanning_grupper,
levels = c(
"Grunnskole eller mindre",
"Videregående",
"Universitet/Høgskole",
"Forskernivå"
)
)
)
# print(grenseverdier)
# Deskriptiv statistikk
# NSD3201 %>%
#   select(Sykefravær_2022, Alder, Utdanning, Kjønn, Tilfredshet, Motivasjon, Barn,
#          Støtte_sjef, Støtte_kollega, Tilbakemelding_sjef, Arbeidsresultater,
#          Grad_selvbestemming_oppgaver, Grad_selvbestemming_arbeid_som_skal_gjøres,
#          Grad_arbeidstempo, Grad_påvirke_beslutning_arbeid,
#          For_mye_arbeid, Høyt_arbeidstempo, Ekstra_arbeid) %>%
#   summary()
# library(kableExtra)
#
# # 1) Først sørg for at du har formue_gruppe som faktor med labels c("Lav","Middels","Høy")
# #    (antatt allerede laget tidligere)
#
# # 2) Velg hvilke variabler du vil beskrive
# vars <- c("Sykefravær_2022", "Alder", "Tilfredshet", "Motivasjon")
#
# # 3) Lag deskriptiv per formuegruppe
# df_formue_deskr <- NSD3201 %>%
#   group_by(Formue_grupper) %>%
#   summarise(across(all_of(vars),
#                    list(N    = ~n(),
#                         Mean = ~round(mean(.x, na.rm = TRUE), 2),
#                         SD   = ~round(sd(.x,   na.rm = TRUE), 2)),
#                    .names = "{.col}_{.fn}")) %>%
#   ungroup()
#
# # 4) Snu data slik at grupper blir kolonner
# df_formue_wide <- df_formue_deskr %>%
#   pivot_longer(-Formue_grupper,
#                names_to = c("Variable", "Stat"),
#                names_sep = "_") %>%
#   pivot_wider(names_from = Formue_grupper, values_from = value)
#
# # 5) Skriv ut som LaTeX-tabell
# df_formue_wide %>%
#   arrange(Variable, Stat) %>%
#   kable("latex", booktabs = TRUE,
#         caption = "Deskriptiv statistikk etter formuegruppe",
#         label   = "tab:deskr_formue") %>%
#   kable_styling(latex_options = c("hold_position","repeat_header"))
NSD3201 %>%
group_by(Utdanning_grupper) %>%
summarise(across(all_of(vars),
list(N    = ~n(),
Mean = ~round(mean(.x, na.rm = TRUE), 2),
SD   = ~round(sd(.x,   na.rm = TRUE), 2)),
.names = "{.col}_{.fn}")) %>%
# ... deretter samme pivot_longer()/pivot_wider() +
```{r}
sjekk <-NSD3201 %>%
group_by(Utdanning) %>%
summarise(across(all_of(vars),
list(N    = ~n(),
Mean = ~round(mean(.x, na.rm = TRUE), 2),
SD   = ~round(sd(.x,   na.rm = TRUE), 2)),
.names = "{.col}_{.fn}")) %>%
pivot_longer(-Formue_grupper,
names_to = c("Variable", "Stat"),
names_sep = "_") %>%
pivot_wider(names_from = Formue_grupper, values_from = value)
# 1) Gjør om kjønn-koden til en faktor
NSD3201 <- NSD3201 %>%
mutate(
kjønn_f = factor(Kjønn,
levels = c(1, 2),
labels = c("Mann", "Kvinne"))
)
# 2) Summer opp per kjønn
kjønn_summ <- df %>%
group_by(kjønn_f) %>%
summarise(
N         = n(),
pct       = round(N / nrow(df) * 100, 1),
mean_sf   = round(mean(Sykefravær_2022, na.rm = TRUE), 2),
sd_sf     = round(sd(Sykefravær_2022, na.rm = TRUE), 2)
)
# 2) Summer opp per kjønn
kjønn_summ <- NSD3201 %>%
group_by(kjønn_f) %>%
summarise(
N         = n(),
pct       = round(N / nrow(df) * 100, 1),
mean_sf   = round(mean(Sykefravær_2022, na.rm = TRUE), 2),
sd_sf     = round(sd(Sykefravær_2022, na.rm = TRUE), 2)
)
View(kjønn_summ)
rm(list = ls())
library(tidyverse)
library(zoo)
library(scales)
library(ggrepel)
library(readxl)
library(httr)
library(jsonlite)
library(rjstat)
library(readr)
NSD3201 <- read_csv("Data/NSD3201.csv", show_col_types = FALSE)
# count(NSD3201, wkapinnt+aksje+rentinnt > lonn)
# NSD3201 %>%
#   mutate(lonn = as.numeric(lonn),
#          wkapinnt = as.numeric(wkapinnt),
#          aksje = as.numeric(aksje),
#          rentinnt = as.numeric(rentinnt)) %>%
#   mutate(total = wkapinnt+aksje+rentinnt) %>%
#   mutate(diff = lonn - total) %>%
#   ggplot(aes(x = sfpros_uten_feriekorr_2022, y = diff)) +
#   geom_point()
# NSD3201 %>%
#   mutate(sfpros_uten_feriekorr_2022 = as.numeric(sfpros_uten_feriekorr_2022),
#          sfpros_uten_feriekorr_2023 = as.numeric(sfpros_uten_feriekorr_2023),
#          kullaldr = as.numeric(kullaldr)) %>%
#   ggplot(aes(x = kullaldr)) +
#   geom_point(aes(y=sfpros_uten_feriekorr_2023), color="red", alpha=0.4) +
#   geom_point(aes(y=sfpros_uten_feriekorr_2022), color="blue", alpha=0.2)
NSD3201 <- NSD3201 %>%
transmute(
# Avhengig, hoveduavhengig og kontrollvariabler
Sykefravær_2022 = sfpros_uten_feriekorr_2022,
Sykefravær_2023 = sfpros_uten_feriekorr_2023,
Formue = agg_f_08,
Alder = kullaldr,
Utdanning = utdnivaa,
Kjønn = Kjonn,
Tilfredshet = Sp59g,
Motivasjon = SpMotEng_ny,
Barn = barn05,
# Jobbressurser
Støtte_sjef = QPS72_ny,
Støtte_kollega = QPS73_ny,
Tilbakemelding_sjef = Raad3a_ny,
Arbeidsresultater = QPS78_ny,
Grad_selvbestemming_oppgaver = Sp56a2,
Grad_selvbestemming_arbeid_som_skal_gjøres = Sp56b2,
Grad_arbeidstempo = QPS47,
Grad_påvirke_beslutning_arbeid = QPS53,
# Jobbkrav
For_mye_arbeid = QPS15_ny,
Høyt_arbeidstempo = QPS14_ny,
Ekstra_arbeid = Sp47f) %>%
#fjerner NA verdier
drop_na()
NSD3201 <- NSD3201 %>%
mutate(
Formue_grupper = ntile(Formue, 3),
Formue_grupper = factor(Formue_grupper,
levels = 1:3,
labels = c("Lav Formue", "Middels formue", "Høy formue")),
)
NSD3201 <- NSD3201 %>%
mutate(Log_formue = log1p(Formue))
# Ser verdier for formuegruppene
grenseverdier <- quantile(
NSD3201$Formue,
probs = c(0, 1/3, 2/3, 1),
na.rm = TRUE
)
# Deler alder inn i likt breddeintervall
NSD3201 <- NSD3201 %>%
mutate(
Alder_grupper = cut(Alder,
breaks = c(18, 30, 40, 50, 60, 66),
right = FALSE,
labels = c("18–29", "30–39", "40–49", "50–59", "60–66")
)
)
# Fikser Kjønn variabelen fra 1 og 2 til dummy
NSD3201 <- NSD3201 %>%
mutate(Kvinne = if_else(Kjønn == 2, 1L, 0L))
# Lager færre nivåer på utdanning for enklere tolkning
NSD3201 <- NSD3201 %>%
filter(Utdanning != 9) %>%  # dropp uoppgitt helt
mutate(
Utdanning_grupper = case_when(
Utdanning %in% 2                     ~ "Grunnskole eller mindre",
Utdanning %in% c(3, 4, 5)            ~ "Videregående",
Utdanning %in% c(6, 7)               ~ "Universitet/Høgskole",
Utdanning == 8                       ~ "Forskernivå"
),
Utdanning_grupper = factor(
Utdanning_grupper,
levels = c(
"Grunnskole eller mindre",
"Videregående",
"Universitet/Høgskole",
"Forskernivå"
)
)
)
# print(grenseverdier)
# Deskriptiv statistikk
# NSD3201 %>%
#   select(Sykefravær_2022, Alder, Utdanning, Kjønn, Tilfredshet, Motivasjon, Barn,
#          Støtte_sjef, Støtte_kollega, Tilbakemelding_sjef, Arbeidsresultater,
#          Grad_selvbestemming_oppgaver, Grad_selvbestemming_arbeid_som_skal_gjøres,
#          Grad_arbeidstempo, Grad_påvirke_beslutning_arbeid,
#          For_mye_arbeid, Høyt_arbeidstempo, Ekstra_arbeid) %>%
#   summary()
# library(kableExtra)
#
# # 1) Først sørg for at du har formue_gruppe som faktor med labels c("Lav","Middels","Høy")
# #    (antatt allerede laget tidligere)
#
# # 2) Velg hvilke variabler du vil beskrive
# vars <- c("Sykefravær_2022", "Alder", "Tilfredshet", "Motivasjon")
#
# # 3) Lag deskriptiv per formuegruppe
# df_formue_deskr <- NSD3201 %>%
#   group_by(Formue_grupper) %>%
#   summarise(across(all_of(vars),
#                    list(N    = ~n(),
#                         Mean = ~round(mean(.x, na.rm = TRUE), 2),
#                         SD   = ~round(sd(.x,   na.rm = TRUE), 2)),
#                    .names = "{.col}_{.fn}")) %>%
#   ungroup()
#
# # 4) Snu data slik at grupper blir kolonner
# df_formue_wide <- df_formue_deskr %>%
#   pivot_longer(-Formue_grupper,
#                names_to = c("Variable", "Stat"),
#                names_sep = "_") %>%
#   pivot_wider(names_from = Formue_grupper, values_from = value)
#
# # 5) Skriv ut som LaTeX-tabell
# df_formue_wide %>%
#   arrange(Variable, Stat) %>%
#   kable("latex", booktabs = TRUE,
#         caption = "Deskriptiv statistikk etter formuegruppe",
#         label   = "tab:deskr_formue") %>%
#   kable_styling(latex_options = c("hold_position","repeat_header"))
# 1) Gjør om kjønn-koden til en faktor
NSD3201 <- NSD3201 %>%
mutate(
kjønn_f = factor(Kjønn,
levels = c(1, 2),
labels = c("Mann", "Kvinne"))
)
# 2) Summer opp per kjønn
kjønn_summ <- NSD3201 %>%
group_by(kjønn_f) %>%
reframe(
N         = n(),
pct       = round(N / nrow(df) * 100, 1),
mean_sf   = round(mean(Sykefravær_2022, na.rm = TRUE), 2),
sd_sf     = round(sd(Sykefravær_2022, na.rm = TRUE), 2)
)
View(kjønn_summ)
NSD3201 %>%
# 1) Lag om kjonn til faktor med labels
mutate(
kjønn_f = factor(kjonn,
levels = c(1, 2),
labels = c("Mann", "Kvinne"))
) %>%
# 2) Gruppér og summer opp
group_by(kjønn_f) %>%
summarise(
N       = n(),
pct     = round(N / nrow(NSD3201) * 100, 1),
mean_sf = round(mean(Sykefravær_2022, na.rm = TRUE), 2),
sd_sf   = round(sd(Sykefravær_2022, na.rm = TRUE), 2)
)
NSD3201 %>%
# 1) Lag om kjonn til faktor med labels
mutate(
kjønn_f = factor(Kjønn,
levels = c(1, 2),
labels = c("Mann", "Kvinne"))
) %>%
# 2) Gruppér og summer opp
group_by(kjønn_f) %>%
summarise(
N       = n(),
pct     = round(N / nrow(NSD3201) * 100, 1),
mean_sf = round(mean(Sykefravær_2022, na.rm = TRUE), 2),
sd_sf   = round(sd(Sykefravær_2022, na.rm = TRUE), 2)
)
tabell<-NSD3201 %>%
# 1) Lag om kjonn til faktor med labels
mutate(
kjønn_f = factor(Kjønn,
levels = c(1, 2),
labels = c("Mann", "Kvinne"))
) %>%
# 2) Gruppér og summer opp
group_by(kjønn_f) %>%
summarise(
N       = n(),
pct     = round(N / nrow(NSD3201) * 100, 1),
mean_sf = round(mean(Sykefravær_2022, na.rm = TRUE), 2),
sd_sf   = round(sd(Sykefravær_2022, na.rm = TRUE), 2)
)
View(tabell)
# Lag en fornuftig utdanningskategori
utd_summ <- NSD3201 %>%
group_by(Utdanning_grupper) %>%
summarise(
N       = n(),
pct     = round(N / nrow(NSD3201) * 100, 1),
mean_sf = round(mean(Sykefravær_2022, na.rm = TRUE), 2),
sd_sf   = round(sd(Sykefravær_2022, na.rm = TRUE), 2)
)
print(utd_summ)
